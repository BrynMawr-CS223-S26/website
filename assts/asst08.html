<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>Assignment 8: Some Assembly Required</title>
<link rel="stylesheet" href="../style/cs21.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_assignment_8_some_assembly_required">Assignment 8: Some Assembly Required</a></li>
<li><a href="#_operand_practice">1. Operand practice</a></li>
<li><a href="#_the_answer_is_42">2. The answer is 42</a></li>
<li><a href="#_submit_your_work">3. Submit your work</a></li>
<li><a href="#_extra_credit_0_3_hackers">4. Extra Credit (0.3): Hackers</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_assignment_8_some_assembly_required">Assignment 8: Some Assembly Required</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Due (Hardcopy) Thursday, March 20th</strong></p>
</div>
<div class="paragraph">
<p><strong>This is a written assignment, not a coding assignment!</strong></p>
</div>
<div class="paragraph">
<p>The goals for this assignment are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Understand basic x86_64 assembly instructions, especially memory addressing</p>
</li>
<li>
<p>Visualize the execution of x86_64 assembly instructions</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_operand_practice">1. Operand practice</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Suppose memory has the following values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf08</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf0a</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x3c</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf0c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x14</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf0e</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x04</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x34</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe4</p></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>And suppose our registers have the following values:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf08</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbx</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x44</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x08</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%r8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x01</p></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Fill in the following table with the corresponding form, translation, and
value for each of the given operands.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 57.1428%;">
<col style="width: 14.2858%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operand</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Form</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Translation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rax</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4(%rax)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4(%rax, %r8, 4)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xf00(,%rsi,2)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_the_answer_is_42">2. The answer is 42</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Recall the following example from class and
<a href="https://diveintosystems.org/book/C7-x86_64/functions.html"><em>Dive into
Systems</em></a>. This mysterious program reliably produces the output <code>42</code>. In this
question, you will trace the assembly to understand why.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>#include &lt;stdio.h&gt;

int assign(void) {
    int y = 40;
    return y;
}

int adder(void) {
    int a;
    return a + 2;
}

int main(void) {
    int x;
    assign();
    x = adder();
    printf("x is: %d\n", x);
    return 0;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Suppose that compiling the above program results in the following assembly
instructions (x86_64)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>0000000000001149 &lt;assign&gt;:
    114d: 55                    push   %rbp
    114e: 48 89 e5              mov    %rsp,%rbp
    1151: c7 45 fc 28 00 00 00  movl   $0x28,-0x4(%rbp)
    1158: 8b 45 fc              mov    -0x4(%rbp),%eax
    115b: 5d                    pop    %rbp
    115c: c3                    retq

000000000000115d &lt;adder&gt;:
    1161: 55                    push   %rbp
    1162: 48 89 e5              mov    %rsp,%rbp
    1165: 8b 45 fc              mov    -0x4(%rbp),%eax
    1168: 83 c0 02              add    $0x2,%eax
    116b: 5d                    pop    %rbp
    116c: c3                    retq

000000000000116d &lt;main&gt;:
    1171: 55                    push   %rbp
    1172: 48 89 e5              mov    %rsp,%rbp
    1175: 48 83 ec 10           sub    $0x10,%rsp
    1179: e8 cb ff ff ff        callq  1149 &lt;assign&gt;
    117e: e8 da ff ff ff        callq  115d &lt;adder&gt;
    1183: 89 45 fc              mov    %eax,-0x4(%rbp)
    1186: 8b 45 fc              mov    -0x4(%rbp),%eax
    1189: 89 c6                 mov    %eax,%esi
    118b: 48 8d 3d 72 0e 00 00  lea    0xe72(%rip),%rdi
    1192: b8 00 00 00 00        mov    $0x0,%eax
    1197: e8 b4 fe ff ff        callq  1050 &lt;printf@plt&gt;
    119c: b8 00 00 00 00        mov    $0x0,%eax
    11a1: c9                    leaveq
    11a2: c3                    retq</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In <em>The Hitchhiker&#8217;s Guide to the Galaxy</em> by Douglas Adams, the "Answer to the
Ultimate Question of Life, the Universe, and Everything," calculated by an
enormous supercomputer named Deep Thought over a period of 7.5 million years.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>1) Suppose this is the state of the stack immediately prior to executing <code>main</code>
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>000000000000116d &lt;main&gt;:
--&gt; 1171: 55                    push   %rbp
    1172: 48 89 e5              mov    %rsp,%rbp
    1175: 48 83 ec 10           sub    $0x10,%rsp
    1179: e8 cb ff ff ff        callq  1149 &lt;assign&gt;
    117e: e8 da ff ff ff        callq  115d &lt;adder&gt;
    1183: 89 45 fc              mov    %eax,-0x4(%rbp)
    1186: 8b 45 fc              mov    -0x4(%rbp),%eax
    1189: 89 c6                 mov    %eax,%esi</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">379</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1578</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1171</p></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>2) What are the contents of registers and the stack after executing <code>mov %rsp, %rbp</code>?
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>000000000000116d &lt;main&gt;:
    1171: 55                    push   %rbp
--&gt; 1172: 48 89 e5              mov    %rsp,%rbp
    1175: 48 83 ec 10           sub    $0x10,%rsp
    1179: e8 cb ff ff ff        callq  1149 &lt;assign&gt;
    117e: e8 da ff ff ff        callq  115d &lt;adder&gt;
    1183: 89 45 fc              mov    %eax,-0x4(%rbp)
    1186: 8b 45 fc              mov    -0x4(%rbp),%eax
    1189: 89 c6                 mov    %eax,%esi</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>3) What is the state of registers and the stack after executing <code>sub $0x10, %rsp</code>?
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>000000000000116d &lt;main&gt;:
    1171: 55                    push   %rbp
    1172: 48 89 e5              mov    %rsp,%rbp
--&gt; 1175: 48 83 ec 10           sub    $0x10,%rsp
    1179: e8 cb ff ff ff        callq  1149 &lt;assign&gt;
    117e: e8 da ff ff ff        callq  115d &lt;adder&gt;
    1183: 89 45 fc              mov    %eax,-0x4(%rbp)
    1186: 8b 45 fc              mov    -0x4(%rbp),%eax
    1189: 89 c6                 mov    %eax,%esi</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>4) What is the state of registers and the stack after executing <code>callq 0x1149 &lt;assign&gt;</code>?
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>000000000000116d &lt;main&gt;:
    1171: 55                    push   %rbp
    1172: 48 89 e5              mov    %rsp,%rbp
    1175: 48 83 ec 10           sub    $0x10,%rsp
--&gt; 1179: e8 cb ff ff ff        callq  1149 &lt;assign&gt;
    117e: e8 da ff ff ff        callq  115d &lt;adder&gt;
    1183: 89 45 fc              mov    %eax,-0x4(%rbp)
    1186: 8b 45 fc              mov    -0x4(%rbp),%eax
    1189: 89 c6                 mov    %eax,%esi</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>5) Skipping ahead, what is the state of registers and the stack when the program executes <code>pop %rbp</code>?
What two changes occur during <code>pop</code>?
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>0000000000001149 &lt;assign&gt;:
    114d: 55                    push   %rbp
    114e: 48 89 e5              mov    %rsp,%rbp
    1151: c7 45 fc 28 00 00 00  movl   $0x28,-0x4(%rbp)
    1158: 8b 45 fc              mov    -0x4(%rbp),%eax
--&gt; 115b: 5d                    pop    %rbp
    115c: c3                    retq</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>6) What is the state of registers and the stack after executing <code>retq</code>?
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>0000000000001149 &lt;assign&gt;:
    114d: 55                    push   %rbp
    114e: 48 89 e5              mov    %rsp,%rbp
    1151: c7 45 fc 28 00 00 00  movl   $0x28,-0x4(%rbp)
    1158: 8b 45 fc              mov    -0x4(%rbp),%eax
    115b: 5d                    pop    %rbp
--&gt; 115c: c3                    retq</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>7) Skipping ahead, what are the state of registers and the stack when executing <code>retq</code> in adder?
Please show the before and after state (cross out old values).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>000000000000115d &lt;adder&gt;:
    1161: 55                    push   %rbp
    1162: 48 89 e5              mov    %rsp,%rbp
    1165: 8b 45 fc              mov    -0x4(%rbp),%eax
    1168: 83 c0 02              add    $0x2,%eax
    116b: 5d                    pop    %rbp
--&gt; 116c: c3                    retq</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%eax</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%edi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rsp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rbp</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">%rip</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>"Stack top"</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stack value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#160;<br></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xe68</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>8) Consider the call the printf, <code>callq 1050 &lt;printf@plt&gt;</code>. The previous lines place the first
argument to printf into <code>%rdi</code>. Assume this contains "x is %d\n". The second argument will be
placed in <code>%esi</code>. What value will %esi containin?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>000000000000116d &lt;main&gt;:
    1171: 55                    push   %rbp
    1172: 48 89 e5              mov    %rsp,%rbp
    1175: 48 83 ec 10           sub    $0x10,%rsp
    1179: e8 cb ff ff ff        callq  1149 &lt;assign&gt;
    117e: e8 da ff ff ff        callq  115d &lt;adder&gt;
    1183: 89 45 fc              mov    %eax,-0x4(%rbp)
    1186: 8b 45 fc              mov    -0x4(%rbp),%eax
    1189: 89 c6                 mov    %eax,%esi
    118b: 48 8d 3d 72 0e 00 00  lea    0xe72(%rip),%rdi
    1192: b8 00 00 00 00        mov    $0x0,%eax
    1197: e8 b4 fe ff ff        callq  1050 &lt;printf@plt&gt;
    119c: b8 00 00 00 00        mov    $0x0,%eax
    11a1: c9                    leaveq
    11a2: c3                    retq</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_submit_your_work">3. Submit your work</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is a written assignment. Please submit a hard-copy in either Lecture or
Lab, or submit to either Nina Fichera&#8217;s office (Park 348) or Aline Normoyle&#8217;s
office (Park 200B).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extra_credit_0_3_hackers">4. Extra Credit (0.3): Hackers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In class, we looked at how we can cheat at a guessing game by overriding the
return address of a function to jump to the <code>endGame</code> function.  In this question,
you can use the same techniques to</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Determine the secret codes of a program from the binary executable and partial source code.</p>
</li>
<li>
<p>Develop a buffer overrun exploit to call a function directly, without using the secret codes.</p>
</li>
<li>
<p><a href="secretGame-x86-64.tar.gz">Download the binary</a></p>
</li>
<li>
<p><a href="https://diveintosystems.org/book/C3-C_debug/gdb_assembly.html#_debugging_assembly_code">Dive into systems: Debugging assembly code</a></p>
</li>
<li>
<p><a href="https://diveintosystems.org/singlepage/#_real_world_buffer_overflow">Dive into systems: Buffer overflow</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>1) What is the secret number?
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p>
</div>
<div class="paragraph">
<p>2) What is the secret string?
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p>
</div>
<div class="paragraph">
<p>3) Give the buffer contents that can be used to overwrite the stack and jump to the funtion, <code>endGame</code>.
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br>
&#160;<br></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2026-01-19 20:28:28 -0500
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>